services:
- name: service_raw_to_Sv
  tags:
  - raw2Sv
  description: service_raw_to_Sv
  schedule:
    anchor_date: D20241007-T035100
    interval_mins: 10
  logging:
    handler: service_raw_to_Sv
  infrastructure:
    workpool:
      name: sv
      workqueue: default
      type: Process 
  stages:
  - name: Sv_flow
    module: echodataflow.deployment.flow 
    tasks:
    - name: edf_open_raw
      module: echodataflow.tasklib.echopype
      task_params: 
        sonar_model: EK80
    - name: edf_Sv
      module: echodataflow.tasklib.echopype
    stage_params:
      prefect_config: # Configure any prefect related settings for a flow. For an exhaustive list of configurations refer <https://docs.prefect.io/2.11.5/concepts/flows/#flow-settings>. Task based configurations are optimized and handled by echodataflow 
        retries: 3 # Number of retries before failing the flow
        task_runner: DaskTaskRunner() # Configure Runner setting for this specific stage
      options: # Echodataflow master flow configuration options
        save_offline: true 
        use_offline: true # Skip this process if zarr files are already present in the output directory.      
        group: False # Group Converted files based on Transect  
    source:
      path: s3://ncei-wcsd-archive/data/raw/Bell_M._Shimada/SH1707/EK60/Summer2017-D20170623-T153732.raw # Single path, list or paths or a dict with some key and value as list of paths
      storage_options:
        anon: true
    destination:
      path: ./processed
